var ue=Object.create;var A=Object.defineProperty,pe=Object.defineProperties,ce=Object.getOwnPropertyDescriptor,de=Object.getOwnPropertyDescriptors,me=Object.getOwnPropertyNames,H=Object.getOwnPropertySymbols,fe=Object.getPrototypeOf,Q=Object.prototype.hasOwnProperty,dt=Object.prototype.propertyIsEnumerable;var ct=(e,t,o)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,g=(e,t)=>{for(var o in t||(t={}))Q.call(t,o)&&ct(e,o,t[o]);if(H)for(var o of H(t))dt.call(t,o)&&ct(e,o,t[o]);return e},v=(e,t)=>pe(e,de(t)),i=(e,t)=>A(e,"name",{value:t,configurable:!0});var mt=(e,t)=>{var o={};for(var r in e)Q.call(e,r)&&t.indexOf(r)<0&&(o[r]=e[r]);if(e!=null&&H)for(var r of H(e))t.indexOf(r)<0&&dt.call(e,r)&&(o[r]=e[r]);return o};var ge=(e,t)=>{for(var o in t)A(e,o,{get:t[o],enumerable:!0})},ft=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of me(t))!Q.call(e,n)&&n!==o&&A(e,n,{get:()=>t[n],enumerable:!(r=ce(t,n))||r.enumerable});return e};var a=(e,t,o)=>(o=e!=null?ue(fe(e)):{},ft(t||!e||!e.__esModule?A(o,"default",{value:e,enumerable:!0}):o,e)),he=e=>ft(A({},"__esModule",{value:!0}),e);var Se={};ge(Se,{AlignmentButtons:()=>Y,ClearButtons:()=>at,DefaultEditorOptions:()=>ee,FormatButtons:()=>J,LevelSelect:()=>lt,LinkButtons:()=>et,ListButtons:()=>K,QuoteButtons:()=>rt,RichTextInput:()=>Be,RichTextInputToolbar:()=>st,TiptapEditorContext:()=>_,TiptapEditorProvider:()=>X,useEditorSelection:()=>Z,useTiptapEditor:()=>h});module.exports=he(Se);var R=a(require("react")),ut=require("react"),Qt=a(require("clsx")),j=require("@tiptap/react"),Xt=a(require("@tiptap/starter-kit")),Jt=a(require("@tiptap/extension-underline")),Kt=a(require("@tiptap/extension-link")),Yt=a(require("@tiptap/extension-text-align")),Zt=require("@mui/material"),te=require("@mui/material/styles"),W=require("ra-core"),w=require("ra-ui-materialui");var ht=a(require("react"));var gt=require("react"),_=(0,gt.createContext)(void 0);var X=i(({children:e,value:t})=>ht.createElement(_.Provider,{value:t},e),"TiptapEditorProvider");var E=a(require("react")),Wt=require("@mui/material/styles");var T=a(require("react")),F=require("react"),S=require("@mui/material"),vt=a(require("@mui/icons-material/FormatBold")),Tt=a(require("@mui/icons-material/FormatItalic")),Et=a(require("@mui/icons-material/FormatUnderlined")),Lt=a(require("@mui/icons-material/FormatStrikethrough")),xt=a(require("@mui/icons-material/Code")),Bt=require("ra-core");var I=require("react");var h=i(()=>{let[e,t]=(0,I.useState)(!1),o=(0,I.useContext)(_);return(0,I.useEffect)(()=>{let r=i(()=>{t(!0)},"onReady");return o!=null&&(t(o.isEditable),o.on("create",r)),()=>{o!=null&&o.off("create",r)}},[o]),e?o:null},"useTiptapEditor");var J=i(e=>{let t=h(),o=(0,Bt.useTranslate)(),[r,n]=(0,F.useState)([]),m=o("ra.tiptap.bold",{_:"Bold"}),u=o("ra.tiptap.italic",{_:"Italic"}),b=o("ra.tiptap.underline",{_:"Underline"}),c=o("ra.tiptap.strike",{_:"Strikethrough"}),f=o("ra.tiptap.code",{_:"Code"});(0,F.useEffect)(()=>{let l=i(()=>{n(()=>bt.reduce((p,s)=>(t&&t.isActive(s)&&p.push(s),p),[]))},"handleUpdate");return t&&(t.on("update",l),t.on("selectionUpdate",l)),()=>{t&&(t.off("update",l),t.off("selectionUpdate",l))}},[t]);let d=i((l,p)=>{bt.forEach(s=>{let C=t&&t.isActive(s)&&!p.includes(s),k=t&&!t.isActive(s)&&p.includes(s);(C||k)&&be[s](t)})},"handleChange");return T.createElement(S.ToggleButtonGroup,v(g({},e),{disabled:!(t!=null&&t.isEditable),onChange:d,value:r}),T.createElement(S.ToggleButton,{value:"bold","aria-label":m,title:m},T.createElement(vt.default,{fontSize:"inherit"})),T.createElement(S.ToggleButton,{value:"italic","aria-label":u,title:u},T.createElement(Tt.default,{fontSize:"inherit"})),T.createElement(S.ToggleButton,{value:"underline","aria-label":b,title:b},T.createElement(Et.default,{fontSize:"inherit"})),T.createElement(S.ToggleButton,{value:"strike","aria-label":c,title:c},T.createElement(Lt.default,{fontSize:"inherit"})),T.createElement(S.ToggleButton,{value:"code","aria-label":f,title:f},T.createElement(xt.default,{fontSize:"inherit"})))},"FormatButtons"),bt=["bold","italic","underline","strike","code"],be={bold:e=>e.chain().focus().toggleBold().run(),italic:e=>e.chain().focus().toggleItalic().run(),underline:e=>e.chain().focus().toggleUnderline().run(),strike:e=>e.chain().focus().toggleStrike().run(),code:e=>e.chain().focus().toggleCode().run()};var z=a(require("react")),N=require("react"),O=require("@mui/material"),Ct=a(require("@mui/icons-material/FormatListBulleted")),St=a(require("@mui/icons-material/FormatListNumbered")),Pt=require("ra-core");var K=i(e=>{let t=h(),o=(0,Pt.useTranslate)(),r=o("ra.tiptap.list_bulleted",{_:"Bulleted list"}),n=o("ra.tiptap.list_numbered",{_:"Numbered list"}),[m,u]=(0,N.useState)(),b=i((c,f)=>{Rt.forEach(d=>{let l=t&&t.isActive(d)&&f!==d,p=t&&!t.isActive(d)&&f===d;(l||p)&&ve[d](t)})},"handleChange");return(0,N.useEffect)(()=>{let c=i(()=>{u(()=>Rt.reduce((f,d)=>t&&t.isActive(d)?d:f,void 0))},"handleUpdate");return t&&(t.on("update",c),t.on("selectionUpdate",c)),()=>{t&&(t.off("update",c),t.off("selectionUpdate",c))}},[t]),z.createElement(O.ToggleButtonGroup,v(g({},e),{disabled:!(t!=null&&t.isEditable),exclusive:!0,onChange:b,value:m}),z.createElement(O.ToggleButton,{value:"bulletList","aria-label":r,title:r},z.createElement(Ct.default,{fontSize:"inherit"})),z.createElement(O.ToggleButton,{value:"orderedList","aria-label":n,title:n},z.createElement(St.default,{fontSize:"inherit"})))},"ListButtons"),Rt=["bulletList","orderedList"],ve={bulletList:e=>e.chain().focus().toggleBulletList().run(),orderedList:e=>e.chain().focus().toggleOrderedList().run()};var x=a(require("react")),$=require("react"),y=require("@mui/material"),kt=a(require("@mui/icons-material/FormatAlignCenter")),At=a(require("@mui/icons-material/FormatAlignLeft")),It=a(require("@mui/icons-material/FormatAlignRight")),zt=a(require("@mui/icons-material/FormatAlignJustify")),Mt=require("ra-core");var Y=i(e=>{let t=h(),o=(0,Mt.useTranslate)(),[r,n]=(0,$.useState)("left"),m=o("ra.tiptap.align_left",{_:"Align left"}),u=o("ra.tiptap.align_right",{_:"Align right"}),b=o("ra.tiptap.align_center",{_:"Center"}),c=o("ra.tiptap.align_justify",{_:"Justify"});(0,$.useEffect)(()=>{let d=i(()=>{n(l=>Te.reduce((p,s)=>t&&t.isActive({textAlign:s})?s:p,l))},"handleUpdate");return t&&(t.on("update",d),t.on("selectionUpdate",d)),()=>{t&&(t.off("update",d),t.off("selectionUpdate",d))}},[t]);let f=i((d,l)=>{yt[l]&&yt[l](t)},"handleChange");return x.createElement(y.ToggleButtonGroup,v(g({},e),{disabled:!(t!=null&&t.isEditable),exclusive:!0,onChange:f,value:r}),x.createElement(y.ToggleButton,{value:"left","aria-label":m,title:m},x.createElement(At.default,{fontSize:"inherit"})),x.createElement(y.ToggleButton,{value:"center","aria-label":b,title:b},x.createElement(kt.default,{fontSize:"inherit"})),x.createElement(y.ToggleButton,{value:"right","aria-label":u,title:u},x.createElement(It.default,{fontSize:"inherit"})),x.createElement(y.ToggleButton,{value:"justify","aria-label":c,title:c},x.createElement(zt.default,{fontSize:"inherit"})))},"AlignmentButtons"),Te=["left","center","right","justify","code"],yt={left:e=>e.chain().focus().setTextAlign("left").run(),center:e=>e.chain().focus().setTextAlign("center").run(),right:e=>e.chain().focus().setTextAlign("right").run(),justify:e=>e.chain().focus().setTextAlign("justify").run()};var tt=a(require("react")),_t=require("@mui/material"),Ot=a(require("@mui/icons-material/InsertLink")),Ut=require("ra-core");var G=require("react");var Z=i(()=>{let e=h(),[t,o]=(0,G.useState)(e?e.state.doc.textBetween(e.state.selection.from,e.state.selection.to):null);return(0,G.useEffect)(()=>{let r=i(()=>{o(e?e.state.doc.textBetween(e.state.selection.from,e.state.selection.to):null)},"handleSelectionChange");return e&&e.on("selectionUpdate",r),()=>{e&&e.off("selectionUpdate",r)}},[e]),t},"useEditorSelection");var et=i(e=>{let t=h(),o=(0,Ut.useTranslate)(),r=Z(),n=o("ra.tiptap.link",{_:"Add a link"}),m=i(()=>{if(!t.can().setLink({href:""}))return;let u=window.prompt("URL");t.chain().focus().extendMarkRange("link").setLink({href:u}).run()},"handleClick");return tt.createElement(_t.ToggleButton,v(g({"aria-label":n,title:n},e),{disabled:!(t!=null&&t.isEditable)||!r,value:"link",onClick:m,selected:t&&t.isActive("link")}),tt.createElement(Ot.default,{fontSize:"inherit"}))},"LinkButtons");var ot=a(require("react")),D=require("react"),Ht=require("@mui/material"),Ft=a(require("@mui/icons-material/FormatQuote")),Nt=require("ra-core");var rt=i(e=>{let t=h(),o=(0,Nt.useTranslate)(),[r,n]=(0,D.useState)(!1),m=o("ra.tiptap.blockquote",{_:"Blockquote"});return(0,D.useEffect)(()=>{let u=i(()=>{n(t&&t.isActive("blockquote"))},"handleUpdate");return t&&(t.on("update",u),t.on("selectionUpdate",u)),()=>{t&&(t.off("update",u),t.off("selectionUpdate",u))}},[t]),ot.createElement(Ht.ToggleButton,v(g({"aria-label":m,title:m},e),{disabled:!(t!=null&&t.isEditable),onClick:()=>t.chain().focus().toggleBlockquote().run(),selected:r,value:"quote"}),ot.createElement(Ft.default,{fontSize:"inherit"}))},"QuoteButtons");var it=a(require("react")),$t=require("@mui/material"),Gt=a(require("@mui/icons-material/FormatClear")),Dt=require("ra-core");var at=i(e=>{let t=h(),r=(0,Dt.useTranslate)()("ra.tiptap.clear_format",{_:"Clear format"});return it.createElement($t.ToggleButton,v(g({"aria-label":r,title:r},e),{disabled:!(t!=null&&t.isEditable),value:"clear",onClick:()=>t.chain().focus().unsetAllMarks().run()}),it.createElement(Gt.default,{fontSize:"inherit"}))},"ClearButtons");var P=a(require("react")),U=require("react"),B=require("@mui/material"),V=require("@mui/material/styles"),qt=a(require("@mui/icons-material/ArrowDropDown")),Vt=require("ra-core"),jt=a(require("clsx"));var lt=i(e=>{let t=(0,Vt.useTranslate)(),o=h(),[r,n]=(0,U.useState)(null),{size:m}=e,[u,b]=(0,U.useState)(q[0]),c=i((l,p)=>{n(null);let s=q[p];s.value==="paragraph"?o.chain().focus().setParagraph().run():s.value==="heading"&&o.chain().focus().setHeading({level:s.level}).run()},"handleMenuItemClick"),f=i(l=>{n(l.currentTarget)},"handleClickListItem"),d=i(l=>{n(null)},"handleClose");return(0,U.useEffect)(()=>{let l=i(()=>{b(p=>q.reduce((s,C)=>o&&(C.value==="paragraph"&&o.isActive("paragraph")||o.isActive("heading",{level:C.level}))?C:s,p))},"handleUpdate");return o&&(o.on("update",l),o.on("selectionUpdate",l)),()=>{o&&(o.off("update",l),o.off("selectionUpdate",l))}},[o]),P.createElement(Ee,null,P.createElement(B.List,{component:"nav","aria-label":t("ra.tiptap.select_level",{_:"Select the level"}),dense:!0,disablePadding:!0,className:M.list},P.createElement(B.ListItem,{button:!0,"aria-haspopup":"true","aria-controls":"level-menu","aria-label":t("ra.tiptap.current_level",{_:"Current level"}),disabled:!(o!=null&&o.isEditable),onClick:f,className:(0,jt.default)({[M.sizeSmall]:m==="small",[M.sizeLarge]:m==="large"})},P.createElement(B.ListItemText,{primary:t(u.label,{_:u.defaultLabel})}),P.createElement(qt.default,null))),P.createElement(B.Menu,{anchorEl:r,open:Boolean(r),id:"level-menu",onClose:d},q.map((l,p)=>P.createElement(B.MenuItem,{key:l.label,selected:l===u,onClick:s=>{c(s,p)}},t(l.label,{_:l.defaultLabel})))))},"LevelSelect"),q=[{label:"ra.tiptap.paragraph",defaultLabel:"Normal",value:"paragraph"},{label:"ra.tiptap.heading1",defaultLabel:"Heading 1",value:"heading",level:1},{label:"ra.tiptap.heading2",defaultLabel:"Heading 2",value:"heading",level:2},{label:"ra.tiptap.heading3",defaultLabel:"Heading 3",value:"heading",level:3},{label:"ra.tiptap.heading4",defaultLabel:"Heading 4",value:"heading",level:4},{label:"ra.tiptap.heading5",defaultLabel:"Heading 5",value:"heading",level:5},{label:"ra.tiptap.heading6",defaultLabel:"Heading 6",value:"heading",level:6}],nt="RaRichTextInputLevelSelect",M={list:`${nt}-list`,sizeSmall:`${nt}-sizeSmall`,sizeLarge:`${nt}-sizeLarge`},Ee=(0,V.styled)("div")(({theme:e})=>({[`&.${M.list}`]:{borderRadius:e.shape.borderRadius,border:`1px solid ${(0,V.alpha)(e.palette.action.active,.12)}`},[`& .${M.sizeSmall}`]:{paddingTop:1,paddingBottom:1,"& .MuiTypography-root":{fontSize:e.typography.pxToRem(13)}},[`& .${M.sizeLarge}`]:{paddingTop:8,paddingBottom:8,"& .MuiTypography-root":{fontSize:e.typography.pxToRem(15)}}}));var st=i(e=>{let n=e,{size:t="medium",children:o=E.createElement(E.Fragment,null,E.createElement(lt,{size:t}),E.createElement(J,{size:t}),E.createElement(Y,{size:t}),E.createElement(K,{size:t}),E.createElement(et,{size:t}),E.createElement(rt,{size:t}),E.createElement(at,{size:t}))}=n,r=mt(n,["size","children"]);return E.createElement(xe,g({className:wt.root},r),o)},"RichTextInputToolbar"),Le="RaRichTextInputToolbar",wt={root:`${Le}-root`},xe=(0,Wt.styled)("div")(({theme:e})=>({[`&.${wt.root}`]:{display:"flex",marginBottom:e.spacing(1),alignItems:"center","& > *":{marginRight:e.spacing(1)},"& > *:last-child":{marginRight:0}}}));var Be=i(e=>{let{className:t,defaultValue:o="",disabled:r=!1,editorOptions:n=ee,fullWidth:m,helperText:u,label:b,readOnly:c=!1,source:f,toolbar:d}=e,l=(0,W.useResourceContext)(e),{id:p,field:s,isRequired:C,fieldState:k,formState:{isSubmitted:ie}}=(0,W.useInput)(v(g({},e),{source:f,defaultValue:o})),L=(0,j.useEditor)(v(g({},n),{editable:!r&&!c,content:s.value,editorProps:{attributes:{id:p}}})),{error:ae,invalid:ne,isTouched:le}=k;return(0,ut.useEffect)(()=>{!L||L.setOptions({editable:!r&&!c,editorProps:{attributes:{id:p}}})},[r,L,c,p]),(0,ut.useEffect)(()=>{if(!L)return;let pt=i(()=>{if(L.isEmpty){s.onChange(""),s.onBlur();return}let se=L.getHTML();s.onChange(se),s.onBlur()},"handleEditorUpdate");return L.on("update",pt),()=>{L.off("update",pt)}},[L,s]),R.createElement(w.Labeled,{isRequired:C,label:b,id:`${p}-label`,color:k!=null&&k.invalid?"error":void 0,source:f,resource:l,fullWidth:m},R.createElement(Re,{className:(0,Qt.default)("ra-input",`ra-input-${f}`,t),editor:L,error:ae,helperText:u,id:p,isTouched:le,isSubmitted:ie,invalid:ne,toolbar:d||R.createElement(st,null)}))},"RichTextInput"),Re=i(({className:e,editor:t,error:o,fullWidth:r,helperText:n,id:m,isTouched:u,isSubmitted:b,invalid:c,toolbar:f})=>R.createElement(Ce,{className:e},R.createElement(X,{value:t},f,R.createElement(j.EditorContent,{"aria-labelledby":`${m}-label`,className:re.editorContent,editor:t})),R.createElement(Zt.FormHelperText,{className:(u||b)&&c?"ra-rich-text-input-error":"",error:(u||b)&&c},R.createElement(w.InputHelperText,{touched:u||b,error:o==null?void 0:o.message,helperText:n}))),"RichTextInputContent"),ee={extensions:[Xt.default,Jt.default,Kt.default,Yt.default.configure({types:["heading","paragraph"]})]},oe="RaRichTextInput",re={editorContent:`${oe}-editorContent`},Ce=(0,te.styled)("div",{name:oe,overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"flex",flexDirection:"column",alignItems:"center",[`& .${re.editorContent}`]:{width:"100%","& .ProseMirror":{backgroundColor:e.palette.background.default,borderColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)",borderRadius:e.shape.borderRadius,borderStyle:"solid",borderWidth:"1px",padding:e.spacing(1),'&[contenteditable="false"], &[contenteditable="false"]:hover, &[contenteditable="false"]:focus':{backgroundColor:e.palette.action.disabledBackground},"&:hover":{backgroundColor:e.palette.action.hover},"&:focus":{backgroundColor:e.palette.background.default},"& p":{margin:"0 0 1em 0","&:last-child":{marginBottom:0}}}}}));0&&(module.exports={AlignmentButtons,ClearButtons,DefaultEditorOptions,FormatButtons,LevelSelect,LinkButtons,ListButtons,QuoteButtons,RichTextInput,RichTextInputToolbar,TiptapEditorContext,TiptapEditorProvider,useEditorSelection,useTiptapEditor});
//# sourceMappingURL=index.js.map